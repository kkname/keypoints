# /tools/cfgs/dataset_configs/custom_dataset_kp.yaml

# 关键：指向我们修改后的CustomDataset类
# pcdet会根据这个名字在 pcdet/datasets/custom/custom_dataset.py 中找到 CustomDataset 类
DATASET: 'CustomDataset'

# 数据集根目录的路径，相对于 key-point/ 主目录
# 例如，如果您的数据在 key-point/data/custom/，这里就写 'data/custom'
DATA_PATH: 'data/custom' # <-- 需要您修改

# 点云文件的扩展名
POINT_CLOUD_EXTENSION: .bin

# 您要训练的物体类别
CLASS_NAMES: ['Human']

# 关键：定义您数据集中每个物体的关键点数量
NUM_KEYPOINTS: 14

# 定义处理的点云范围 [x_min, y_min, z_min, x_max, y_max, z_max]
# 请根据您自己数据的坐标范围进行调整，这非常重要
POINT_CLOUD_RANGE: [-75.2, -75.2, -2, 75.2, 75.2, 4] # <-- 强烈建议您修改

# 定义数据集划分，指向ImageSets文件夹下的文件名
DATA_SPLIT:
    train: train
    test: val # 如果您有验证集的话

# 定义预处理后生成的infos.pkl文件的路径
# 路径相对于 DATA_PATH
INFO_PATH:
    train: [custom_infos_train.pkl]
    test: [custom_infos_val.pkl]

# 定义数据增强和预处理流程
DATA_PROCESSOR:
    # 过滤掉在POINT_CLOUD_RANGE范围之外的点和物体框
    -   NAME: mask_points_and_boxes_outside_range
        REMOVE_OUTSIDE_BOXES: True

    # 打乱点的顺序，增加模型鲁棒性
    -   NAME: shuffle_points
        SHUFFLE_ENABLED: {
            'train': True,
            'test': False
        }

    # 定义体素化参数，后续VFE模块会使用
    -   NAME: transform_points_to_voxels
        VOXEL_SIZE: [0.1, 0.1, 0.15] # <-- 体素大小，可以根据您的数据密度调整
        MAX_POINTS_PER_VOXEL: 5
        MAX_NUMBER_OF_VOXELS: {
            'train': 150000,
            'test': 150000,
        }

    # 定义数据增强器
    -   NAME: data_augmentor
        DISABLE_AUG_LIST: ['placeholder']
        AUG_CONFIG_LIST:
            # 随机沿x轴和y轴翻转
            -   NAME: random_world_flip
                ALONG_AXIS_LIST: ['x', 'y']

            # 随机全局旋转 (-45° 到 +45°)
            -   NAME: random_world_rotation
                WORLD_ROT_ANGLE: [-0.78539816, 0.78539816]

            # 随机全局缩放 (0.95倍 到 1.05倍)
            -   NAME: random_world_scaling
                WORLD_SCALE_RANGE: [0.95, 1.05]

GET_ITEM_LIST: ["points"]
FOV_POINTS_ONLY: False