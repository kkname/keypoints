# /tools/cfgs/dataset_configs/custom_dataset_kp.yaml (Corrected Structure)

DATASET: 'CustomDatasetKP'
DATA_PATH: 'data/custom' # <-- 需要您修改
POINT_CLOUD_EXTENSION: .bin
CLASS_NAMES: ['Human']
NUM_KEYPOINTS: 14

POINT_FEATURE_ENCODING:
  encoding_type: 'absolute_coordinates_encoding'
  used_feature_list: ['x', 'y', 'z', 'intensity']
  src_feature_list: ['x', 'y', 'z', 'intensity']

EVAL_METRIC: custom_kp

POINT_CLOUD_RANGE: [-75.2, -75.2, -2, 75.2, 75.2, 4] # <-- 强烈建议您修改

DATA_SPLIT:
    train: train
    test: val

INFO_PATH:
    train: [custom_infos_train.pkl]
    test: [custom_infos_val.pkl]

# --- 新增：时序处理相关参数 ---
SEQUENCE_LENGTH: 3  # 定义每个序列包含的帧数 (例如3帧)

# 为了将不同帧的数据堆叠(stack)成一个张量，我们需要将它们填充到相同的大小
# 您需要根据您数据集中最极端的情况来设定这两个值
MAX_POINTS_PER_FRAME: 160000  # 数据集中单帧最多包含的点数
MAX_PEOPLE_PER_FRAME: 4      # 数据集中单帧最多包含的人数
# -------------------------------

# --- 结构修正：DATA_PROCESSOR 只包含它自己的处理步骤 ---
DATA_PROCESSOR:
    - NAME: mask_points_and_boxes_outside_range
      REMOVE_OUTSIDE_BOXES: True

    - NAME: shuffle_points
      SHUFFLE_ENABLED: {
          'train': True,
          'test': False
      }

    - NAME: transform_points_to_voxels
      VOXEL_SIZE: [0.1, 0.1, 0.15]
      MAX_POINTS_PER_VOXEL: 5
      MAX_NUMBER_OF_VOXELS: {
          'train': 150000,
          'test': 150000,
      }
# --------------------------------------------------------

# --- 结构修正：将数据增强器移到独立的顶层配置块 ---
DATA_AUGMENTOR:
    DISABLE_AUG_LIST: ['placeholder']
    AUG_CONFIG_LIST:
        - NAME: random_world_flip
          ALONG_AXIS_LIST: ['x', 'y']

        - NAME: random_world_rotation
          WORLD_ROT_ANGLE: [-0.39, 0.39]

        - NAME: random_world_scaling
          WORLD_SCALE_RANGE: [0.95, 1.05]
# ----------------------------------------------------

GET_ITEM_LIST: ["points"]
FOV_POINTS_ONLY: False